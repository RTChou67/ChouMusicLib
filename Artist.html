<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>歌手主页</title>
        <style>
            :root {
                --bg: #0f1724;
                --card: #182638;
                --muted: #9aa4b2;
                --accent: #7c3aed;
                --glass: rgba(255, 255, 255, 0.04);
            }
            html,
            body {
                height: 100%;
                margin: 0;
                font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
                background: linear-gradient(180deg, #071226 0%, #081227 100%);
                color: #e6eef6;
            }
            .view-container {
                max-width: 1200px;
                margin: 0 auto;
                padding: 24px;
            }
            .button {
                background: var(--glass);
                border: 1px solid rgba(255, 255, 255, 0.1);
                color: inherit;
                padding: 10px 16px;
                border-radius: 8px;
                cursor: pointer;
                font-size: 15px;
                transition: background-color 0.2s, border-color 0.2s;
                text-decoration: none;
            }
            .button:hover {
                background-color: rgba(255, 255, 255, 0.1);
            }

            /* NEW: Added a class for the header */
            .page-header {
                margin-bottom: 24px;
            }

            .artist-header {
                display: flex;
                align-items: flex-start;
                gap: 24px;
                margin-bottom: 24px;
                background: var(--card);
                padding: 24px;
                border-radius: 12px;
            }
            .artist-photo {
                width: 180px;
                height: 180px;
                object-fit: cover;
                border-radius: 8px;
                flex-shrink: 0;
                background-color: #0b1220;
            }
            .artist-info {
                flex-grow: 1;
            }
            .artist-info h1 {
                font-size: 32px;
                margin: 0 0 12px 0;
            }
            .artist-meta {
                color: var(--muted);
                font-size: 14px;
                line-height: 1.8;
            }
            .artist-meta strong {
                color: #e6eef6;
                font-weight: 500;
                margin-right: 8px;
            }

            .artist-section {
                background: var(--card);
                padding: 24px;
                border-radius: 12px;
                margin-bottom: 24px;
            }
            .artist-section h2 {
                margin-top: 0;
                font-size: 20px;
                border-bottom: 1px solid var(--glass);
                padding-bottom: 12px;
                margin-bottom: 16px;
            }
            .artist-bio {
                font-size: 15px;
                line-height: 1.7;
                color: var(--muted);
            }
            .tags-container {
                display: flex;
                flex-wrap: wrap;
                gap: 8px;
            }
            .tag {
                display: inline-block;
                background-color: var(--glass);
                padding: 6px 12px;
                border-radius: 999px;
                font-size: 13px;
            }

            #albumGrid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
                gap: 24px;
                margin-top: 24px;
            }
            .album-card {
                background: var(--card);
                border-radius: 8px;
                overflow: hidden;
                text-decoration: none;
                color: inherit;
                transition: transform 0.2s, box-shadow 0.2s;
            }
            .album-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            }
            .album-cover {
                width: 100%;
                height: 220px;
                background: #0b1220;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            .album-cover img {
                width: 100%;
                height: 100%;
                object-fit: cover;
            }
            .album-info {
                padding: 16px;
            }
            .album-title {
                font-size: 16px;
                font-weight: 600;
                margin: 0;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }
            .album-artist {
                font-size: 14px;
                color: var(--muted);
                margin: 4px 0 0;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }
            .album-meta-small {
                font-size: 12px;
                color: var(--muted);
                margin-top: 10px;
            }
            /* NEW: Added hidden class, consistent with index.html */
            .hidden {
                display: none !important;
            }
        </style>
    </head>
    <body>
        <div class="view-container">
            <header class="page-header">
                <a href="/index.html" class="button">返回音乐库</a>
            </header>

            <div id="artist-content">
                <div class="artist-header">
                    <img id="artist-photo" src="" alt="歌手照片" class="artist-photo" />
                    <div class="artist-info">
                        <h1 id="artist-name">正在加载...</h1>
                        <div class="artist-meta">
                            <div><strong>国籍:</strong> <span id="artist-country"></span></div>
                            <div><strong>活跃状态:</strong> <span id="artist-status"></span></div>
                        </div>
                    </div>
                </div>

                <div class="artist-section">
                    <h2>介绍</h2>
                    <p id="artist-biography" class="artist-bio"></p>
                </div>

                <div class="artist-section">
                    <h2>音乐类型</h2>
                    <div id="artist-genres" class="tags-container"></div>
                </div>

                <div class="artist-section">
                    <h2>音乐标签</h2>
                    <div id="artist-tags" class="tags-container"></div>
                </div>

                <div class="artist-section">
                    <h2>专辑列表</h2>
                    <div id="albumGrid"></div>
                </div>
            </div>
        </div>

        <script>
            document.addEventListener("DOMContentLoaded", () => {
                const urlParams = new URLSearchParams(window.location.search);
                const artistId = urlParams.get("id");

                if (!artistId) {
                    document.getElementById("artist-name").textContent = "错误：未提供歌手ID";
                    return;
                }

                fetch(`/Artists/${artistId}.json`)
                    .then((response) => {
                        if (!response.ok) {
                            throw new Error(`无法加载歌手信息 (ID: ${artistId})`);
                        }
                        return response.json();
                    })
                    .then((data) => {
                        document.title = data.name;
                        document.getElementById("artist-name").textContent = data.name || "未知歌手";
                        document.getElementById("artist-country").textContent = data.country || "未知";
                        document.getElementById("artist-status").textContent = data.status || "未知";
                        document.getElementById("artist-biography").textContent = data.biography || "暂无介绍。";

                        const photoEl = document.getElementById("artist-photo");
                        // MODIFIED: Use classList to toggle visibility
                        if (data.photoUrl) {
                            photoEl.src = data.photoUrl;
                            photoEl.alt = data.name;
                            photoEl.classList.remove("hidden");
                        } else {
                            photoEl.classList.add("hidden");
                        }

                        const genresContainer = document.getElementById("artist-genres");
                        genresContainer.innerHTML = "";
                        (data.genres || []).forEach((genre) => {
                            const span = document.createElement("span");
                            span.className = "tag";
                            span.textContent = genre;
                            genresContainer.appendChild(span);
                        });

                        const tagsContainer = document.getElementById("artist-tags");
                        tagsContainer.innerHTML = "";
                        (data.tags || []).forEach((tag) => {
                            const span = document.createElement("span");
                            span.className = "tag";
                            span.textContent = tag;
                            tagsContainer.appendChild(span);
                        });

                        const albumGrid = document.getElementById("albumGrid");
                        albumGrid.innerHTML = "";
                        (data.discography || []).forEach((album) => {
                            const card = document.createElement("div");
                            card.className = "album-card";

                            const cover = album.coverUrl
                                ? `<img src="${album.coverUrl}" alt="${album.title}">`
                                : `<span>无封面</span>`;

                            card.innerHTML = `
                            <div class="album-cover">${cover}</div>
                            <div class="album-info">
                                <h3 class="album-title">${album.title || "未知标题"}</h3>
                                <p class="album-artist">${data.name}</p>
                                <div class="album-meta-small">
                                    ${album.year || "未知年份"} · ${album.type || "未知类型"}
                                </div>
                            </div>
                        `;
                            albumGrid.appendChild(card);
                        });
                    })
                    .catch((error) => {
                        console.error("加载歌手数据失败:", error);
                        document.getElementById("artist-name").textContent = "加载失败";
                        document.getElementById("artist-biography").textContent = error.message;
                    });
            });
        </script>
    </body>
</html>
